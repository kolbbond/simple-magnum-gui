get_filename_component(guild_CMAKE_DIR "${CMAKE_CURRENT_LIST_FILE}" PATH)
include(CMakeFindDependencyMacro)

message(STATUS "GUILD CONFIG")

# add path
list(APPEND CMAKE_MODULE_PATH ${guild_CMAKE_DIR})
list(REMOVE_AT CMAKE_MODULE_PATH -1)

# dependencies are SDL and OpenGL

# SDL
if(OFF)
find_dependency(SDL2)
if(NOT TARGET SDL2)
    message(STATUS "SDL2 is not target")
endif()

# OpenGL
if(NOT TARGET OpenGL)
    message(STATUS "OpenGL is not target")
  set(OpenGL_GL_PREFERENCE "GLVND")
find_dependency(OpenGL)
endif()

endif()

# MagnumIntegration
if(NOT TARGET MagnumIntegration)
    message(STATUS "MagnumIntegration is not target")
    find_dependency(MagnumIntegration)
    #find_package(MagnumIntegration REQUIRED ImGui)
    find_dependency(MagnumIntegration REQUIRED ImGui)
endif()

# Corrade
if(NOT TARGET Corrade)
    message(STATUS "Corrade is not target")
    find_dependency(Corrade)
    find_dependency(Corrade REQUIRED Main)
endif()

# Magnum
if(NOT TARGET Magnum)
    message(STATUS "Magnum is not target")
    #    find_dependency(Magnum)
    #find_dependency(Magnum REQUIRED Sdl2Application)
    #find_dependency(Magnum REQUIRED GL)
    find_dependency(Magnum REQUIRED 
        GL
        MeshTools
        Primitives
        Shaders
        Trade
        Sdl2Application
)
endif()

# find implot?
#if(NOT TARGET ImPlot)
#message(STATUS "ImPlot not target, find dependency")
#find_dependency(ImPlot)
#endif()



# ImGui
#if(NOT TARGET ImGui)
#message(STATUS "ImGui is not target")
#find_dependency(ImGui)
#endif()

# lua 
if(@USE_LUA@)
    if(@LUA_FOUND@)
        if(NOT TARGET Lua)
            message(STATUS "Lua is not target")
            find_dependency(Lua)
            add_library(Lua::Lua INTERFACE IMPORTED)
            set_target_properties(Lua::Lua PROPERTIES
                INTERFACE_INCLUDE_DIRECTORIES "${LUA_INCLUDE_DIR}"
                INTERFACE_LINK_LIBRARIES "${LUA_LIBRARIES}")
        endif()
    endif()
endif()

# matlab
if(@USE_MATLAB@)
    if(@MATLAB_FOUND@)
    if(NOT TARGET Matlab)
        message(STATUS "Matlab is not target")
      find_dependency(Matlab)
    endif()
    endif()
endif()

# if we are not guild include guild!
if(NOT TARGET guild)
    message(STATUS "guild is not target")
    message(STATUS "ADD GUILD TARGETS")
    # include definitions
    include("${guild_CMAKE_DIR}/guildTargets.cmake")
endif()
set(guild_LIBRARIES guild)

